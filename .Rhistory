df <- as.data.frame(lapply(df, mean_impute))
inters[[pitch_type]] <- df
}
cv_inter <- function(pitch, fold){
prepare <- function(data) {
folds = data %>%
select(mlbAM_ID) %>%
distinct(mlbAM_ID) %>%
rowwise() %>%
mutate(group = sample(seq(1, 5, 1), 1))
gam_data <- data %>%
left_join(folds, by = 'mlbAM_ID')
return(gam_data)
}
gam_data <- prepare(inters[[pitch]])
train <- gam_data %>% filter(group != fold)
exclude_columns <- c("mlbAM_ID", "Year", "player_name", "pitch_usage", "run_value_per_100", "index")
exclude_columns <- c(exclude_columns, names(train)[grep("spin_rate", names(train))])
exclude_columns <- c(exclude_columns, names(train)[grep("FF", names(train))])
selected_data <- train[, !(names(train) %in% exclude_columns)]
remaining_columns <- setdiff(names(selected_data), c("est_woba"))
rhs <- paste('s(', remaining_columns, ', k = 3)', sep = '', collapse = ' + ')
fml <- paste('est_woba ~', rhs, collapse = ' ')
gam <- gam(as.formula(fml), data = train, family = gaussian, method = "REML")
# gam <- gam(est_woba ~ s(Stuff) + s)
test <- gam_data %>% filter(group == fold)
y_pred <- test %>% mutate(prediction = predict(gam, test)) %>%
filter(!is.na(prediction))
gam_pred_df = data.frame(observed = test$est_woba, prediction = y_pred$prediction)
return(gam_pred_df)
}
FF_preds_inter = data.frame()
FF_preds_inter <- rbind(cv_inter("FF", "1"),
cv_inter("FF", "2"),
cv_inter("FF", "3"),
cv_inter("FF", "4"),
cv_inter("FF", "5"))
FF_rmses_inter <- round(rmse(FF_preds_inter$observed, FF_preds_inter$prediction), 4)
FC_preds_inter = data.frame()
FC_preds_inter <- rbind(cv_inter("FC", "1"),
cv_inter("FC", "2"),
cv_inter("FC", "3"),
cv_inter("FC", "4"),
cv_inter("FC", "5"))
FC_rmses_inter <- round(rmse(FC_preds_inter$observed, FC_preds_inter$prediction), 4)
SL_preds_inter = data.frame()
SL_preds_inter <- rbind(cv_inter("SL", "1"),
cv_inter("SL", "2"),
cv_inter("SL", "3"),
cv_inter("SL", "4"),
cv_inter("SL", "5"))
SL_rmses_inter <- round(rmse(SL_preds_inter$observed, SL_preds_inter$prediction), 4)
SI_preds_inter = data.frame()
SI_preds_inter <- rbind(cv_inter("SI", "1"),
cv_inter("SI", "2"),
cv_inter("SI", "3"),
cv_inter("SI", "4"),
cv_inter("SI", "5"))
SI_rmses_inter <- round(rmse(SI_preds_inter$observed, SI_preds_inter$prediction), 4)
SI_preds_inter = data.frame()
SI_preds_inter <- rbind(cv_inter("SI", "1"),
cv_inter("SI", "2"),
cv_inter("SI", "3"),
cv_inter("SI", "4"),
cv_inter("SI", "5"))
SI_rmses_inter <- round(rmse(SI_preds_inter$observed, SI_preds_inter$prediction), 4)
CH_preds_inter = data.frame()
CH_preds_inter <- rbind(cv_inter("CH", "1"),
cv_inter("CH", "2"),
cv_inter("CH", "3"),
cv_inter("CH", "4"),
cv_inter("CH", "5"))
CH_rmses_inter <- round(rmse(CH_preds_inter$observed, CH_preds_inter$prediction), 4)
CU_preds_inter = data.frame()
CU_preds_inter <- rbind(cv_inter("CU", "1"),
cv_inter("CU", "2"),
cv_inter("CU", "3"),
cv_inter("CU", "4"),
cv_inter("CU", "5"))
CU_rmses_inter <- round(rmse(CU_preds_inter$observed, CU_preds_inter$prediction), 4)
# Chunk 82: Inter GAM Four Seams
FF_preds_inter %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("FF Inter-Pitch xwOBA GAM Predictions"),
caption = paste("RMSE:",
round(rmse(FF_preds_inter$observed, FF_preds_inter$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 83: Inter GAM Cutters
FC_preds_inter %>%
ggplot(aes(x = observed, y = prediction)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Observed",
y = "Predicted",
title = paste("FC Inter-Pitch xwOBA GAM Predictions"),
caption = paste("RMSE:",
round(rmse(FC_preds_inter$observed, FC_preds_inter$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 84: Inter GAM Sinkers
SI_preds_inter %>%
ggplot(aes(x = observed, y = prediction)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Observed",
y = "Predicted",
title = paste("SI Inter-Pitch xwOBA GAM Predictions"),
caption = paste("RMSE:",
round(rmse(SI_preds_inter$observed, SI_preds_inter$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 85: Inter GAM Sliders
SL_preds_inter %>%
ggplot(aes(x = observed, y = prediction)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Observed",
y = "Predicted",
title = paste("SL Inter-Pitch xwOBA GAM Predictions"),
caption = paste("RMSE:",
round(rmse(SL_preds_inter$observed, SL_preds_inter$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 86: Inter GAM Curveballs
CU_preds_inter %>%
ggplot(aes(x = observed, y = prediction)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Observed",
y = "Predicted",
title = paste("CU Inter-Pitch xwOBA GAM Predictions"),
caption = paste("RMSE:",
round(rmse(CU_preds_inter$observed, CU_preds_inter$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 87: Inter GAM Change-Up
CH_preds_inter %>%
ggplot(aes(x = observed, y = prediction)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Observed",
y = "Predicted",
title = paste("CH Inter-Pitch xwOBA GAM Predictions"),
caption = paste("RMSE:",
round(rmse(CH_preds_inter$observed, CH_preds_inter$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 88: Inter RF
remove_outliers <- function(df, col_names) {
for (col_name in col_names) {
Q1 <- quantile(df[[col_name]], 0.25)
Q3 <- quantile(df[[col_name]], 0.75)
IQR <- Q3 - Q1
lower_bound <- Q1 - 1.5 * IQR
upper_bound <- Q3 + 1.5 * IQR
df <- df[df[[col_name]] >= lower_bound & df[[col_name]] <= upper_bound, ]
}
return(df)
}
inters = list()
for (pitch_type in pitch_types) {
file_path = sprintf('./Ethan-Data/Inter-Pitch/%s_interpitch_2020-2022.csv', pitch_type)
df <- read.csv(file_path)
df <- remove_outliers(df, col_names = c('est_woba', 'Stuff'))
df <- as.data.frame(lapply(df, mean_impute))
inters[[pitch_type]] <- df
}
cv_inter_rf <- function(pitch, fold){
prepare <- function(data) {
folds = data %>%
select(mlbAM_ID) %>%
distinct(mlbAM_ID) %>%
rowwise() %>%
mutate(group = sample(seq(1, 5, 1), 1))
rf_data <- data %>%
left_join(folds, by = 'mlbAM_ID')
return(rf_data)
}
rf_data <- prepare(inters[[pitch]])
train <- rf_data %>% filter(group != fold)
test <- rf_data %>% filter(group == fold)
exclude_columns <- c("mlbAM_ID", "Year", "player_name", "pitch_usage", "run_value_per_100", "index", "group")
exclude_columns <- c(exclude_columns, names(train)[grep("spin_rate", names(train))])
exclude_columns <- c(exclude_columns, names(train)[grep("FF", names(train))])
selected_data <- train[, !(names(train) %in% exclude_columns)]
rf <- ranger(est_woba ~ ., data = selected_data, num.trees = 500,
importance = "impurity")
# gam <- gam(est_woba ~ s(Stuff) + s)
y_pred <- predict(rf, test) %>% as.data.frame()
rf_pred_df = data.frame(observed = test$est_woba, prediction = y_pred$prediction)
return(rf_pred_df)
}
FF_preds_inter_rf = data.frame()
FF_preds_inter_rf <- rbind(cv_inter_rf("FF", "1"),
cv_inter_rf("FF", "2"),
cv_inter_rf("FF", "3"),
cv_inter_rf("FF", "4"),
cv_inter_rf("FF", "5"))
FF_rmses_inter_rf <- round(rmse(FF_preds_inter_rf$observed, FF_preds_inter_rf$prediction), 4)
FC_preds_inter_rf = data.frame()
FC_preds_inter_rf <- rbind(cv_inter_rf("FC", "1"),
cv_inter_rf("FC", "2"),
cv_inter_rf("FC", "3"),
cv_inter_rf("FC", "4"),
cv_inter_rf("FC", "5"))
FC_rmses_inter_rf <- round(rmse(FC_preds_inter_rf$observed, FC_preds_inter_rf$prediction), 4)
SL_preds_inter_rf = data.frame()
SL_preds_inter_rf <- rbind(cv_inter_rf("SL", "1"),
cv_inter_rf("SL", "2"),
cv_inter_rf("SL", "3"),
cv_inter_rf("SL", "4"),
cv_inter_rf("SL", "5"))
SL_rmses_inter_rf <- round(rmse(SL_preds_inter_rf$observed, SL_preds_inter_rf$prediction), 4)
SI_preds_inter_rf = data.frame()
SI_preds_inter_rf <- rbind(cv_inter_rf("SI", "1"),
cv_inter_rf("SI", "2"),
cv_inter_rf("SI", "3"),
cv_inter_rf("SI", "4"),
cv_inter_rf("SI", "5"))
SI_rmses_inter_rf <- round(rmse(SI_preds_inter_rf$observed, SI_preds_inter_rf$prediction), 4)
CH_preds_inter_rf = data.frame()
CH_preds_inter_rf <- rbind(cv_inter_rf("CH", "1"),
cv_inter_rf("CH", "2"),
cv_inter_rf("CH", "3"),
cv_inter_rf("CH", "4"),
cv_inter_rf("CH", "5"))
CH_rmses_inter_rf <- round(rmse(CH_preds_inter_rf$observed, CH_preds_inter_rf$prediction), 4)
CU_preds_inter_rf = data.frame()
CU_preds_inter_rf <- rbind(cv_inter_rf("CU", "1"),
cv_inter_rf("CU", "2"),
cv_inter_rf("CU", "3"),
cv_inter_rf("CU", "4"),
cv_inter_rf("CU", "5"))
CU_rmses_inter_rf <- round(rmse(CU_preds_inter_rf$observed, CU_preds_inter_rf$prediction), 4)
# Chunk 89: Inter RF Four Seams
FF_preds_inter_rf %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("FF Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(FF_preds_inter_rf$observed, FF_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 90: Inter RF Cutters
FC_preds_inter_rf %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("FC Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(FC_preds_inter_rf$observed, FC_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 91: Inter RF Sinkers
SI_preds_inter_rf %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("SI Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(SI_preds_inter_rf$observed, SI_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 92: Inter RF Sliders
SL_preds_inter_rf %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("SL Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(SL_preds_inter_rf$observed, SL_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 93: Inter RF Curveballs
CU_preds_inter_rf %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("CU Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(CU_preds_inter_rf$observed, CU_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 94: Inter RF Change-Ups
CH_preds_inter_rf %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("CH Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(CH_preds_inter_rf$observed, CH_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 95: RMSE Collection
intra_gam <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(rmse(FF_preds$observed, FF_preds$prediction),
rmse(FC_preds$observed, FC_preds$prediction),
rmse(SI_preds$observed, SI_preds$prediction),
rmse(SL_preds$observed, SL_preds$prediction),
rmse(CU_preds$observed, CU_preds$prediction),
rmse(CH_preds$observed, CH_preds$prediction))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Intra_GAM" = V2)
inter_gam <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(rmse(FF_preds_inter$observed, FF_preds_inter$prediction),
rmse(FC_preds_inter$observed, FC_preds_inter$prediction),
rmse(SI_preds_inter$observed, SI_preds_inter$prediction),
rmse(SL_preds_inter$observed, SL_preds_inter$prediction),
rmse(CU_preds_inter$observed, CU_preds_inter$prediction),
rmse(CH_preds_inter$observed, CH_preds_inter$prediction))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Inter_GAM" = V2)
inter_rf <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(rmse(FF_preds_inter_rf$observed, FF_preds_inter_rf$prediction),
rmse(FC_preds_inter_rf$observed, FC_preds_inter_rf$prediction),
rmse(SI_preds_inter_rf$observed, SI_preds_inter_rf$prediction),
rmse(SL_preds_inter_rf$observed, SL_preds_inter_rf$prediction),
rmse(CU_preds_inter_rf$observed, CU_preds_inter_rf$prediction),
rmse(CH_preds_inter_rf$observed, CH_preds_inter_rf$prediction))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Inter_RF" = V2)
ff <- inters[["FF"]] %>%
mutate(prediction = mean(est_woba))
fc <- inters[["FC"]] %>%
mutate(prediction = mean(est_woba))
ch <- inters[["CH"]] %>%
mutate(prediction = mean(est_woba))
cu <- inters[["CU"]] %>%
mutate(prediction = mean(est_woba))
sl <- inters[["SL"]] %>%
mutate(prediction = mean(est_woba))
si <- inters[["SI"]] %>%
mutate(prediction = mean(est_woba))
intercept <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(round(rmse(ff$est_woba, ff$prediction), 4),
rmse(fc$est_woba, fc$prediction),
rmse(si$est_woba, si$prediction),
rmse(sl$est_woba, sl$prediction),
rmse(cu$est_woba, cu$prediction),
rmse(ch$est_woba, ch$prediction))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Intercept" = V2)
rmse_data <- intercept %>%
left_join(intra_gam, by = "pitch_type") %>%
left_join(inter_gam, by = "pitch_type") %>%
left_join(inter_rf, by = "pitch_type")
rmse_data <- rmse_data %>%
mutate(
Intercept = as.numeric(Intercept),
Intra_GAM = as.numeric(Intra_GAM),
Inter_GAM = as.numeric(Inter_GAM),
Inter_RF = as.numeric(Inter_RF))
# Chunk 96: RMSE Comp
rmse_pivot <- rmse_data %>%
pivot_longer(c(Intercept:Inter_RF)) %>%
rename(RMSE = value, model = name)
rmse_pivot <- rmse_pivot %>%
mutate(RMSE = as.numeric(RMSE))
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE)) +
geom_boxplot(color = "white", show.legend = FALSE, aes(fill = model)) +
geom_jitter(width = 0, aes(color = pitch_type)) +
theme_dark() +
labs(x = "Model",
color = "Pitch")
rmse_data %>%
mutate(Intercept = round(Intercept, 4),
Intra_GAM = round(Intra_GAM, 4),
Inter_GAM = round(Inter_GAM, 4),
Inter_RF = round(Inter_RF,4)) %>%
mutate(pitch_type = str_replace(pitch_type, "FF", "Four-Seam"),
pitch_type = str_replace(pitch_type, "FC", "Cutter"),
pitch_type = str_replace(pitch_type, "SI", "Sinker"),
pitch_type = str_replace(pitch_type, "SL", "Slider"),
pitch_type = str_replace(pitch_type, "CU", "Curveball"),
pitch_type = str_replace(pitch_type, "CH", "Change-Up")) %>%
kable(digits = 4, align = "c",
col.names = c("Pitch", "Intercept", "Intra-Pitch GAM",
"Inter-Pitch GAM", "Inter-Pitch RF")) %>%
kable_styling(full_width = T)
# Chunk 97: RMSE Intra GAM
rmse_data %>%
select(pitch_type, Intra_GAM) %>%
mutate(Intra_GAM = round(Intra_GAM, 4)) %>%
ggplot(aes(x = pitch_type, y = Intra_GAM, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Intra-Pitch GAM") +
theme_dark()
# Chunk 98: RMSE Inter GAM
rmse_data %>%
select(pitch_type, Inter_GAM) %>%
mutate(Inter_GAM = round(Inter_GAM, 4)) %>%
ggplot(aes(x = pitch_type, y = Inter_GAM, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Inter-Pitch GAM") +
theme_dark()
# Chunk 99: RMSE Inter RF
rmse_data %>%
select(pitch_type, Inter_RF) %>%
mutate(Inter_RF = round(Inter_RF, 4)) %>%
ggplot(aes(x = pitch_type, y = Inter_RF, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Inter-Pitch Random Forest") +
theme_dark()
View(FF_preds_inter)
?cv_inter
View(SL_preds_inter_rf)
data %>% View()
data %>% View()
gam_data %>% View
for (pitch_type in pitch_types) {
file_path = sprintf('./Ethan-Data/Inter-Pitch/%s_interpitch_2020-2022.csv', pitch_type)
df <- read.csv(file_path)
df <- remove_outliers(df, col_names = c('est_woba', 'Stuff'))
df <- as.data.frame(lapply(df, mean_impute))
inters[[pitch_type]] <- df
}
for (pitch_type in pitch_types) {
file_path = sprintf('./Ethan-Data/Inter-Pitch/%s_interpitch_2020-2022.csv', pitch_type)
df <- read.csv(file_path)
df <- remove_outliers(df, col_names = c('est_woba', 'Stuff'))
df <- as.data.frame(lapply(df, mean_impute))
inters[[pitch_type]] <- df
}
View(si)
View(sl)
View(inters)
ch %>% View
write.csv(si, "si.csv")
write.csv(sl, "sl.csv")
write.csv(cu, "cu.csv")
si <- read_csv("CSVs/si.csv")
sl <- read_csv("CSVs/sl.csv")
cu <- read_csv("CSVs/cu.csv")
View(si)
library(tidyverse)
library(ranger)
sl_model <- ranger(est_woba ~ ., data = sl)
si_model <- ranger(est_woba ~ ., data = si)
cu_model <- ranger(est_woba ~ ., data = cu)

scale_x_continuous(labels = scales::comma) +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
grv_ff_2 <- Data2 %>%
filter(pitch_type == "FF") %>%
ggplot(aes(x = avg_speed, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Average Pitch Speed (mph)",
y = "",
color = "Stuff+",
subtitle = "Speed") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(grv_ff_1, grv_ff_2, ncol = 2, top = "Run Value on Four-Seam Fastballs by Spin Rate & Speed")
grv_fc_1 <- Data2 %>%
filter(pitch_type == "FC") %>%
ggplot(aes(x = spin_rate, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Spin Rate (rpm)",
y = "Run Value / 100",
subtitle = "Spin Rate") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
grv_fc_2 <- Data2 %>%
filter(pitch_type == "FC") %>%
ggplot(aes(x = avg_speed, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Average Pitch Speed (mph)",
y = "",
color = "Stuff+",
subtitle = "Speed") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(grv_fc_1, grv_fc_2, ncol = 2, top = "Run Value on Cutters by Spin Rate & Speed")
grv_si_1 <- Data2 %>%
filter(pitch_type == "SI") %>%
ggplot(aes(x = spin_rate, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Spin Rate (rpm)",
y = "Run Value / 100",
subtitle = "Spin Rate") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
grv_si_2 <- Data2 %>%
filter(pitch_type == "SI") %>%
ggplot(aes(x = avg_speed, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Average Pitch Speed (mph)",
y = "",
color = "Stuff+",
subtitle = "Speed") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(grv_si_1, grv_si_2, ncol = 2, top = "Run Value on Sinkers by Spin Rate & Speed")
grv_cu_1 <- Data2 %>%
filter(pitch_type == "CU") %>%
ggplot(aes(x = spin_rate, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Spin Rate (rpm)",
y = "Run Value / 100",
subtitle = "Spin Rate") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
grv_cu_2 <- Data2 %>%
filter(pitch_type == "CU") %>%
ggplot(aes(x = avg_speed, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Average Pitch Speed (mph)",
y = "",
color = "Stuff+",
subtitle = "Speed") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(grv_cu_1, grv_cu_2, ncol = 2, top = "Run Value on Curveballs by Spin Rate & Speed")
grv_ch_1 <- Data2 %>%
filter(pitch_type == "CH" | pitch_type == "FS") %>%
ggplot(aes(x = spin_rate, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Spin Rate (rpm)",
y = "Run Value / 100",
subtitle = "Spin Rate") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
grv_ch_2 <- Data2 %>%
filter(pitch_type == "CH" | pitch_type == "FS") %>%
ggplot(aes(x = avg_speed, y = rv100,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Average Pitch Speed (mph)",
y = "",
color = "Stuff+",
subtitle = "Speed") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(grv_ch_1, grv_ch_2, ncol = 2, top = "Run Value on Change-Ups by Spin Rate & Speed")
g2_sl_1 <- Data2 %>%
filter(pitch_type == "SL") %>%
ggplot(aes(x = pitcher_break_x, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Horizontal Movement (in.)",
y = "wOBA") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
g2_sl_2 <- Data2 %>%
filter(pitch_type == "SL") %>%
ggplot(aes(x = pitcher_break_z, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Vertical Movement (in.)",
y = "",
color = "Stuff+") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(g2_sl_1, g2_sl_2, ncol = 2, top = "wOBA on Sliders by Pitch Movement")
g2_ff_1 <- Data2 %>%
filter(pitch_type == "FF") %>%
ggplot(aes(x = pitcher_break_x, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Horizontal Movement (in.)",
y = "wOBA") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
g2_ff_2 <- Data2 %>%
filter(pitch_type == "FF") %>%
ggplot(aes(x = pitcher_break_z, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Vertical Movement (in.)",
y = "",
color = "Stuff+") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(g2_ff_1, g2_ff_2, ncol = 2, top = "wOBA on Four Seam Fastballs by Pitch Movement")
g2_fc_1 <- Data2 %>%
filter(pitch_type == "FC") %>%
ggplot(aes(x = pitcher_break_x, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Horizontal Movement (in.)",
y = "wOBA") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
g2_fc_2 <- Data2 %>%
filter(pitch_type == "FC") %>%
ggplot(aes(x = pitcher_break_z, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Vertical Movement (in.)",
y = "",
color = "Stuff+") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(g2_fc_1, g2_fc_2, ncol = 2, top = "wOBA on Cutters by Pitch Movement")
g2_si_1 <- Data2 %>%
filter(pitch_type == "SI") %>%
ggplot(aes(x = pitcher_break_x, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Horizontal Movement (in.)",
y = "wOBA") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
g2_si_2 <- Data2 %>%
filter(pitch_type == "SI") %>%
ggplot(aes(x = pitcher_break_z, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Vertical Movement (in.)",
y = "",
color = "Stuff+") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(g2_fc_1, g2_fc_2, ncol = 2, top = "wOBA on Sinkers by Pitch Movement")
g2_cu_1 <- Data2 %>%
filter(pitch_type == "CU") %>%
ggplot(aes(x = pitcher_break_x, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Horizontal Movement (in.)",
y = "wOBA") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
g2_cu_2 <- Data2 %>%
filter(pitch_type == "CU") %>%
ggplot(aes(x = pitcher_break_z, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Vertical Movement (in.)",
y = "",
color = "Stuff+") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(g2_cu_1, g2_cu_2, ncol = 2, top = "wOBA on Curveballs by Pitch Movement")
g2_ch_1 <- Data2 %>%
filter(pitch_type == "CH" | pitch_type == "FS") %>%
ggplot(aes(x = pitcher_break_x, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7, show.legend = FALSE) +
geom_smooth(method = lm, se = FALSE, show.legend = FALSE) +
labs(x = "Horizontal Movement (in.)",
y = "wOBA") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
theme_dark() +
theme(plot.subtitle = element_text(hjust = 0.5))
g2_ch_2 <- Data2 %>%
filter(pitch_type == "CH" | pitch_type == "FS") %>%
ggplot(aes(x = pitcher_break_z, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
labs(x = "Vertical Movement (in.)",
y = "",
color = "Stuff+") +
scale_y_reverse() +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()+
theme(plot.subtitle = element_text(hjust = 0.5),
axis.text.y = element_blank(),
axis.ticks.y = element_blank())
grid.arrange(g2_ch_1, g2_ch_2, ncol = 2, top = "wOBA on Change-Ups by Pitch Movement")
?geom_point
?theme
?theme
rm(g_ch_1)
rm(g_ch_2)
rm(g_cu_1)
rm(g_cu_2)
rm(g_fb_1)
rm(g_fb_2)
rm(g_sl_1)
rm(g_sl_2)
rm(gx_ch_1)
rm(gx_ch_2)
rm(gx_cu_1)
rm(gx_cu_2)
rm(gx_fb_1)
rm(gx_fb_2)
rm(gx_sl_1)
rm(gx_sl_2)
rm(changeup_model)
rm(changeup_reduced)
rm(curveball_model)
rm(curveball_reduced)
rm(slider_model)
rm(slider_reduced)
rm(fastball_model)
rm(fastball_reduced)
rm(fourseam_reduced)
rm(cutter_reduced)
rm(sinker_reduced)
rm(rv_changeup_model)
rm(rv_changeup_reduced)
rm(rv_curveball_model)
rm(rv_curveball_reduced)
rm(rv_slider_model)
rm(rv_slider_reduced)
rm(rv_fastball_model)
rm(rv_fastball_reduced)
rm(rv_fourseam_reduced)
rm(rv_cutter_reduced)
rm(rv_sinker_reduced)
rm(x_changeup_model)
rm(x_changeup_reduced)
rm(x_curveball_model)
rm(x_curveball_reduced)
rm(x_fastball_model)
rm(x_fastball_reduced)
rm(x_slider_model)
rm(x_slider_reduced)
rm(x_fourseam_reduced)
rm(x_cutter_reduced)
rm(x_sinker_reduced)
rm(g_fc_1)
rm(g_fc_2)
rm(g_ff_1)
rm(g_ff_2)
rm(g_sd_1)
rm(g_sd_2)
rm(g_si_1)
rm(g_si_2)
rm(g_sd_1)
rm(g_sd_2)
rm(g_sd1)
rm(g_sd2)
rm(g2_ch_1)
rm(g2_ch_2)
rm(g2_cu_1)
rm(g2_cu_2)
rm(g2_fc_1)
rm(g2_fc_2)
rm(g2_ff_1)
rm(g2_ff_2)
rm(g2_si_1)
rm(g2_si_2)
rm(g2_sl_1)
rm(g2_sl_2)
rm(grv_ch_1)
rm(grv_ch_2)
rm(grv_cu_1)
rm(grv_cu_2)
rm(grv_sl_1)
rm(grv_sl_2)
rm(grv_fc_1)
rm(grv_fc_2)
rm(grv_ff_1)
rm(grv_ff_2)
rm(grv_si_1)
rm(grv_si_2)
rm(gx_ff_1)
rm(gx_ff_2)
rm(gx_fc_1)
rm(gx_fc_2)
rm(gx_si_1)
rm(gx_si_2)
# Inter-Pitch Data ####
sl <- read_csv("SL_inter_pitch.csv")
View(sl)
# Inter-Pitch Data ####
sl <- read_csv("SL_inter_pitch.csv") %>%
mutate(pitch_type = "SL")
View(sl)
View(sl)
View(sl)
View(sl)
View(sl)
# Inter-Pitch Data ####
sl <- read_csv("SL_inter_pitch.csv") %>%
mutate(pitch_type = "SL") %>%
select(pitch_type, player_name:FC_release_pos_z_diff)
View(Data2)
sl <- read_csv("Ethan-Data/Inter-Pitch/2020/2020_SL_inter_pitch.csv") %>%
mutate(pitch_type = "SL", year = "2020") %>%
select(pitch_type, year, player_name:FC_release_pos_z_diff)
View(sl)
sl_2020 <- read_csv("Ethan-Data/Inter-Pitch/2020/2020_SL_inter_pitch.csv") %>%
mutate(pitch_type = "SL", year = "2020") %>%
select(pitch_type, year, player_name:FC_release_pos_z_diff)
ip <- function(url, pitch, season){
read_csv(url) %>%
mutate(pitch_type = pitch, year = season) %>%
select(pitch_type, year, player_name:FC_release_pos_z_diff)
}
sl_2020 <- ip("Ethan-Data/Inter-Pitch/2020/2020_SL_inter_pitch.csv", SL, 2020)
sl_2020 <- ip("Ethan-Data/Inter-Pitch/2020/2020_SL_inter_pitch.csv", "SL", 2020)
sl_2020 <- ip("Ethan-Data/Inter-Pitch/2020/2020_SL_inter_pitch.csv", "SL", 2020)
sl_2020 <- read_csv("Ethan-Data/Inter-Pitch/2020/2020_SL_inter_pitch.csv") %>%
mutate(pitch_type = "SL", year = "2020") %>%
select(pitch_type, year, player_name:FC_release_pos_z_diff)
sl_2020 <- ip("Ethan-Data/Inter-Pitch/2020/2020_SL_inter_pitch.csv", "SL", 2020)
sl_2021 <- ip("Ethan-Data/Inter-Pitch/2021/2021_SL_inter_pitch.csv", "SL", 2021)
sl_2022 <- ip("Ethan-Data/Inter-Pitch/2022/2022_SL_inter_pitch.csv", "SL", 2022)
sl <- rbind(sl_2020, sl_2021, sl_2022)
sl <- rbind(sl_2020, sl_2021, sl_2022)
sl_2022 <- ip("Ethan-Data/Inter-Pitch/2022/2022_SL_inter_pitch.csv", "SL", 2022)
View(sl_2022)
read_csv(Ethan-Data/Inter-Pitch/2022/2022_SL_inter_pitch.csv") %>% View
read_csv("Ethan-Data/Inter-Pitch/2022/2022_SL_inter_pitch.csv") %>% View
View(sl)
View(sl_2020)
View(sl_2020)
sl<- rbind(sl2020, sl2021) %>%
select(-mlbAM_ID) %>%
rbind(sl2022)
sl<- rbind(sl_2020, sl_2021) %>%
select(-mlbAM_ID) %>%
rbind(sl_2022)
View(sl)

panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_vline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Usage (vs. League Average)",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = pitch_per-league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_vline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Usage",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-0.5, 0.75), labels = scales::percent) +
NULL
base <- Data2 %>%
select(Name, year, pitch_hand:Stuff, `Stf+ Pitch`, pitcher_break_z,
pitcher_break_x, avg_speed, spin_rate, pitches_thrown, pitch_per,
run_value:hard_hit_percent, fb_type:speed_diff)
tree_input <- base %>%
filter(!is.na(`Stf+ Pitch`), !is.na(run_value), !is.na(spin_rate),
!is.na(fb_stuff), !is.na(fb_speed), !is.na(fb_thrown),
!is.na(speed_diff)) %>%
select(-Name:-pitch_type_name, -fb_type) %>%
rename(pitch_stuff = `Stf+ Pitch`) %>%
select(-est_woba, -slg, -ba, -run_value_per_100, -run_value, -est_slg,
-est_ba)
mlb_rf <- ranger(woba ~ ., data = tree_input, num.trees = 1000,
importance = "impurity")
mlb_rf
vip(mlb_rf, geom = "point") + theme_bw()
set.seed(13*38*51)
# Lots of Variables
model_data_full <- tree_input %>%
select(woba, pitch_stuff, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
pitch_per, fb_stuff, fb_thrown, speed_diff) %>%
filter(speed_diff != 0)
model_full <- ranger(woba ~ ., data = model_data_full, num.trees = 1000,
importance = "impurity")
vip(model_full, geom = "point") +
labs(title = "Thorough Model",
caption = "Variables: pitch_stuff, pitcher_break_z, pitcher_break_x,
avg_speed, spin_rate, pitch_per, fb_stuff,
fb_thrown, speed_diff") +
theme_bw()
model_data_full %>%
lm(woba ~ pitch_stuff + pitcher_break_z + pitcher_break_x + avg_speed +
spin_rate + pitch_per + fb_stuff + fb_thrown + speed_diff,
data = .) %>%
summary()
tree_1 <- rpart(formula =woba ~ pitch_stuff + pitcher_break_z + pitcher_break_x +
avg_speed + spin_rate + pitch_per + fb_stuff + fb_thrown +
speed_diff,
data = model_data_full, method = "anova")
tree_1 %>% rpart.plot()
# Fewer Variables
model_data_reduced <- tree_input %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
speed_diff) %>%
filter(speed_diff != 0) %>%
select(-speed_diff)
model_reduced <- ranger(woba ~ ., data = model_data_reduced, num.trees = 1000,
importance = "impurity")
vip(model_reduced, geom = "point") +
labs(title = "Reduced Model",
caption = "Variables: pitcher_break_z, pitcher_break_x, avg_speed, spin_rate") +
theme_bw()
model_data_reduced %>%
lm(woba ~ pitcher_break_z + pitcher_break_x +avg_speed + spin_rate, data = .) %>%
summary()
tree_2 <- rpart(formula = woba ~ pitcher_break_z + pitcher_break_x +
avg_speed + spin_rate,
data = model_data_reduced, method = "anova")
tree_2 %>% rpart.plot()
# Fewer Variables, non-comparable population
model_data_reduced <- tree_input %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate)
model_reduced <- ranger(woba ~ ., data = model_data_reduced, num.trees = 1000,
importance = "impurity")
vip(model_reduced, geom = "point") +
labs(title = "Reduced Model",
subtitle = "Primary Fastball Included",
caption = "Variables: pitcher_break_z, pitcher_break_x, avg_speed, spin_rate") +
theme_bw()
slider_reduced <- Data2 %>%
filter(pitch_type == "SL") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
speed_diff)
slider_reduced <- ranger(woba ~ ., data = slider_reduced, num.trees = 1000,
importance = "impurity")
slider_reduced <- Data2 %>%
filter(pitch_type == "SL") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
speed_diff)
slider_reduced <- ranger(woba ~ ., data = slider_reduced, num.trees = 1000,
importance = "impurity")
slider_reduced <- Data2 %>%
filter(pitch_type == "SL") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
speed_diff) %>%
filter(!is.na(spin_rate))
slider_reduced <- ranger(woba ~ ., data = slider_reduced, num.trees = 1000,
importance = "impurity")
slider_reduced <- Data2 %>%
filter(pitch_type == "SL") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
speed_diff) %>%
filter(!is.na(spin_rate), !is.na(speed_diff))
slider_reduced <- ranger(woba ~ ., data = slider_reduced, num.trees = 1000,
importance = "impurity")
vip(slider_reduced, geom = "point") +
labs(title = "Reduced Model",
caption = "Variables: pitcher_break_z, pitcher_break_x, avg_speed, spin_rate") +
theme_bw()
slider_reduced %>%
lm(woba ~ pitcher_break_z + pitcher_break_x +avg_speed + spin_rate, data = .) %>%
summary()
slider_reduced <- Data2 %>%
filter(pitch_type == "SL") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
speed_diff) %>%
filter(!is.na(spin_rate), !is.na(speed_diff))
slider_reduced <- ranger(woba ~ ., data = slider_reduced, num.trees = 1000,
importance = "impurity")
slider_reduced <- Data2 %>%
filter(pitch_type == "SL") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
speed_diff) %>%
filter(!is.na(spin_rate), !is.na(speed_diff))
slider_model <- ranger(woba ~ ., data = slider_reduced, num.trees = 1000,
importance = "impurity")
vip(slider_model, geom = "point") +
labs(title = "Reduced Model",
caption = "Variables: pitcher_break_z, pitcher_break_x, avg_speed, spin_rate") +
theme_bw()
slider_reduced %>%
lm(woba ~ pitcher_break_z + pitcher_break_x +avg_speed + spin_rate, data = .) %>%
summary()
rpart(formula = woba ~ pitcher_break_z + pitcher_break_x +
avg_speed + spin_rate,
data = slider_reduced, method = "anova") %>%
rpart.plot()
View(slider_reduced)
View(Data2)
Data2 %>% filter(pitch_type == "SL", avg_speed >= 90) %>% View()
fastball_reduced <- Data2 %>%
filter(pitch_type == "FC" | pitch_type == "FF" | pitch_type == "SI") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate,
speed_diff, pitch_type) %>%
filter(!is.na(spin_rate), !is.na(speed_diff))
fastball_model <- ranger(woba ~ ., data = fastball_reduced, num.trees = 1000,
importance = "impurity")
vip(fastball_model, geom = "point") +
labs(title = "Reduced Model",
caption = "Variables: pitcher_break_z, pitcher_break_x, avg_speed, spin_rate") +
theme_bw()
rpart(formula = woba ~ pitcher_break_z + pitcher_break_x +
avg_speed + spin_rate,
data = fastball_reduced, method = "anova") %>%
rpart.plot()
fastball_reduced <- Data2 %>%
filter(pitch_type == "FC" | pitch_type == "FF" | pitch_type == "SI") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate, pitch_type) %>%
filter(!is.na(spin_rate), !is.na(speed_diff))
fastball_reduced <- Data2 %>%
filter(pitch_type == "FC" | pitch_type == "FF" | pitch_type == "SI") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate, pitch_type) %>%
filter(!is.na(spin_rate))
fastball_model <- ranger(woba ~ ., data = fastball_reduced, num.trees = 1000,
importance = "impurity")
vip(fastball_model, geom = "point") +
labs(title = "Reduced Model",
caption = "Variables: pitcher_break_z, pitcher_break_x, avg_speed, spin_rate") +
theme_bw()
rpart(formula = woba ~ pitcher_break_z + pitcher_break_x +
avg_speed + spin_rate + pitch_type,
data = fastball_reduced, method = "anova") %>%
rpart.plot()
curveball_reduced <- Data2 %>%
filter(pitch_type == "CU") %>%
select(woba, pitcher_break_z, pitcher_break_x, avg_speed, spin_rate) %>%
filter(!is.na(spin_rate))
curveball_model <- ranger(woba ~ ., data = curveball_reduced, num.trees = 1000,
importance = "impurity")
vip(curveball_model, geom = "point") +
labs(title = "Reduced Model",
caption = "Variables: pitcher_break_z, pitcher_break_x, avg_speed, spin_rate") +
theme_bw()
rpart(formula = woba ~ pitcher_break_z + pitcher_break_x +
avg_speed + spin_rate + pitch_type,
data = curveball_reduced, method = "anova") %>%
rpart.plot()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
theme_classic()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type) +
theme_classic()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_grid(~ pitch_type) +
theme_classic()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type) +
theme_classic()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate",
y = "wOBA",
color = "Stuff+") +
scale_color_gradient(low = "yellow", high = "green") +
theme_classic()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate",
y = "wOBA",
color = "Stuff+") +
scale_color_gradient(low = "yellow", high = "green") +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate",
y = "wOBA",
color = "Stuff+") +
scale_color_gradient(low = "lightgray", high = "green") +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate",
y = "wOBA",
color = "Stuff+") +
scale_color_gradient(low = "white", high = "green") +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate",
y = "wOBA",
color = "Stuff+") +
scale_color_gradient(low = "lightgray", high = "green") +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate",
y = "wOBA",
color = "Stuff+") +
scale_color_gradient(low = "gold", high = "green") +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate",
y = "wOBA",
color = "Stuff+") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate",
y = "wOBA",
color = "Stuff+") +
scale_color_gradient(low = "red", high = "green") +
theme_dark()
scale_x_continuous(labels = scales::comma +
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001)) +
scale_x_continuous(labels = scales::comma) +
theme_dark()
?scale_y_continuous
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
breaks = rep(0, 0.6, 0.1)) +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(limits = c(0, 0.5), breaks = seq(0, 0.5, 0.1),
labels = scales::label_number(scale = 1e-3),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(limits = c(0, 0.5), breaks = seq(0, 0.5, 0.1),
labels = scales::label_number(scale = 1e-3),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous() +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(limits = c(0, 0.5), labels = scales::label_number(scale = 1e-3),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(limits = c(0, 0.5),
labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(limits = c(0, 0.5),
labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(limits = c(0, 0.5),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark()
Data2 %>%
ggplot(aes(x = spin_rate, y = woba,
color = `Stf+ Pitch`)) +
geom_point(alpha = 0.7) +
geom_smooth(method = lm, se = FALSE) +
facet_wrap(~ pitch_type_name) +
labs(x = "Spin Rate (rpm)",
y = "wOBA",
color = "Stuff+",
title = "Spin Rate vs. Stuff+ by Pitch Type") +
scale_color_gradient(low = "red", high = "green") +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05)),
trans = "reverse") +
scale_x_continuous(labels = scales::comma) +
theme_dark()

title = paste("SL Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(SL_preds_inter_rf$observed, SL_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 93: Inter RF Curveballs
CU_preds_inter_rf %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("CU Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(CU_preds_inter_rf$observed, CU_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 94: Inter RF Change-Ups
CH_preds_inter_rf %>%
ggplot(aes(x = prediction, y = observed)) +
geom_point(color = "#FDB827", shape = 18, size = 2.5, alpha = 0.8) +
geom_smooth(se = FALSE, method = lm) +
scale_y_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
scale_x_continuous(labels = scales::comma_format(accuracy = 0.001),
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Predicted",
y = "Observed",
title = paste("CH Inter-Pitch xwOBA RF Predictions"),
caption = paste("RMSE:",
round(rmse(CH_preds_inter_rf$observed, CH_preds_inter_rf$prediction), 4))) +
theme_dark() +
theme(plot.title = element_text(hjust = 0.5))
# Chunk 95: RMSE Collection
intra_gam <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(rmse(FF_preds$observed, FF_preds$prediction),
rmse(FC_preds$observed, FC_preds$prediction),
rmse(SI_preds$observed, SI_preds$prediction),
rmse(SL_preds$observed, SL_preds$prediction),
rmse(CU_preds$observed, CU_preds$prediction),
rmse(CH_preds$observed, CH_preds$prediction))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Intra_GAM" = V2)
inter_gam <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(rmse(FF_preds_inter$observed, FF_preds_inter$prediction),
rmse(FC_preds_inter$observed, FC_preds_inter$prediction),
rmse(SI_preds_inter$observed, SI_preds_inter$prediction),
rmse(SL_preds_inter$observed, SL_preds_inter$prediction),
rmse(CU_preds_inter$observed, CU_preds_inter$prediction),
rmse(CH_preds_inter$observed, CH_preds_inter$prediction))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Inter_GAM" = V2)
inter_rf <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(rmse(FF_preds_inter_rf$observed, FF_preds_inter_rf$prediction),
rmse(FC_preds_inter_rf$observed, FC_preds_inter_rf$prediction),
rmse(SI_preds_inter_rf$observed, SI_preds_inter_rf$prediction),
rmse(SL_preds_inter_rf$observed, SL_preds_inter_rf$prediction),
rmse(CU_preds_inter_rf$observed, CU_preds_inter_rf$prediction),
rmse(CH_preds_inter_rf$observed, CH_preds_inter_rf$prediction))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Inter_RF" = V2)
rmse_data <- intra_gam %>%
left_join(inter_gam, by = "pitch_type") %>%
left_join(inter_rf, by = "pitch_type")
rmse_data <- rmse_data %>%
mutate(
Intra_GAM = as.numeric(Intra_GAM),
Inter_GAM = as.numeric(Inter_GAM),
Inter_RF = as.numeric(Inter_RF))
# Chunk 96: RMSE Intra GAM
rmse_data %>%
select(pitch_type, Intra_GAM) %>%
mutate(Intra_GAM = round(Intra_GAM, 4)) %>%
ggplot(aes(x = pitch_type, y = Intra_GAM, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Intra-Pitch GAM") +
theme_dark()
# Chunk 97: RMSE Inter GAM
rmse_data %>%
select(pitch_type, Inter_GAM) %>%
mutate(Inter_GAM = round(Inter_GAM, 4)) %>%
ggplot(aes(x = pitch_type, y = Inter_GAM, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Inter-Pitch GAM") +
theme_dark()
# Chunk 98: RMSE Inter RF
rmse_data %>%
select(pitch_type, Inter_RF) %>%
mutate(Inter_RF = round(Inter_RF, 4)) %>%
ggplot(aes(x = pitch_type, y = Inter_RF, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Inter-Pitch Random Forest") +
theme_dark()
# Chunk 99: RMSE Comp
rmse_pivot <- rmse_data %>%
pivot_longer(c(Intra_GAM:Inter_RF)) %>%
rename(RMSE = value, model = name)
rmse_pivot <- rmse_pivot %>%
mutate(RMSE = as.numeric(RMSE))
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, fill = model)) +
geom_boxplot(color = "white", show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
# PC wOBA
rm(g_ch_1)
rm(g_ch_2)
rm(g_cu_1)
rm(g_cu_2)
rm(g_sl_1)
rm(g_sl_2)
rm(g_fc_1)
rm(g_fc_2)
rm(g_ff_1)
rm(g_ff_2)
rm(g_si_1)
rm(g_si_2)
# PC xwOBA
rm(gx_ch_1)
rm(gx_ch_2)
rm(gx_cu_1)
rm(gx_cu_2)
rm(gx_ff_1)
rm(gx_ff_2)
rm(gx_fc_1)
rm(gx_fc_2)
rm(gx_si_1)
rm(gx_si_2)
rm(gx_sl_1)
rm(gx_sl_2)
# PC Run Value
rm(grv_ch_1)
rm(grv_ch_2)
rm(grv_cu_1)
rm(grv_cu_2)
rm(grv_sl_1)
rm(grv_sl_2)
rm(grv_fc_1)
rm(grv_fc_2)
rm(grv_ff_1)
rm(grv_ff_2)
rm(grv_si_1)
rm(grv_si_2)
# VIP wOBA
rm(changeup_model)
rm(changeup_reduced)
rm(curveball_model)
rm(curveball_reduced)
rm(slider_model)
rm(slider_reduced)
rm(fastball_model)
rm(fastball_reduced)
rm(fourseam_reduced)
rm(cutter_reduced)
rm(sinker_reduced)
# VIP xwOBA
rm(x_changeup_model)
rm(x_changeup_reduced)
rm(x_curveball_model)
rm(x_curveball_reduced)
rm(x_fastball_model)
rm(x_fastball_reduced)
rm(x_slider_model)
rm(x_slider_reduced)
rm(x_fourseam_reduced)
rm(x_cutter_reduced)
rm(x_sinker_reduced)
# VIP Run Value
rm(rv_changeup_model)
rm(rv_changeup_reduced)
rm(rv_curveball_model)
rm(rv_curveball_reduced)
rm(rv_slider_model)
rm(rv_slider_reduced)
rm(rv_fastball_model)
rm(rv_fastball_reduced)
rm(rv_fourseam_reduced)
rm(rv_cutter_reduced)
rm(rv_sinker_reduced)
# PM wOBA
rm(g2_ch_1)
rm(g2_ch_2)
rm(g2_cu_1)
rm(g2_cu_2)
rm(g2_fc_1)
rm(g2_fc_2)
rm(g2_ff_1)
rm(g2_ff_2)
rm(g2_si_1)
rm(g2_si_2)
rm(g2_sl_1)
rm(g2_sl_2)
# PM xwOBA
rm(gx2_ch_1)
rm(gx2_ch_2)
rm(gx2_cu_1)
rm(gx2_cu_2)
rm(gx2_fc_1)
rm(gx2_fc_2)
rm(gx2_ff_1)
rm(gx2_ff_2)
rm(gx2_si_1)
rm(gx2_si_2)
rm(gx2_sl_1)
rm(gx2_sl_2)
# PM Run Value
rm(grv2_ch_1)
rm(grv2_ch_2)
rm(grv2_cu_1)
rm(grv2_cu_2)
rm(grv2_fc_1)
rm(grv2_fc_2)
rm(grv2_ff_1)
rm(grv2_ff_2)
rm(grv2_si_1)
rm(grv2_si_2)
rm(grv2_sl_1)
rm(grv2_sl_2)
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, fill = model)) +
geom_boxplot(color = "white", show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, fill = model)) +
geom_point(color = "white", show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, color = model)) +
geom_point(show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, color = pitch_type)) +
geom_point(show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE, color = model)) +
geom_point(show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE)) +
geom_boxplot(show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE, color = model)) +
geom_point(show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE, color = model, alpha = 0.5)) +
geom_point(show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
View(rmse_data)
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE, color = model, alpha = 0.5)) +
geom_point() +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE, color = model, alpha = 0.5)) +
geom_point() +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE, color = model, alpha = 0.5)) +
geom_boxplot() +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE, alpha = 0.5)) +
geom_boxplot() +
theme_dark() +
labs(x = "Model")
rmse_data %>%
select(pitch_type, Intra_GAM) %>%
mutate(Intra_GAM = round(Intra_GAM, 4)) %>%
ggplot(aes(x = pitch_type, y = Intra_GAM, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Intra-Pitch GAM") +
theme_dark()
rmse_data %>%
select(pitch_type, Inter_GAM) %>%
mutate(Inter_GAM = round(Inter_GAM, 4)) %>%
ggplot(aes(x = pitch_type, y = Inter_GAM, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Inter-Pitch GAM") +
theme_dark()
rmse_data %>%
select(pitch_type, Inter_RF) %>%
mutate(Inter_RF = round(Inter_RF, 4)) %>%
ggplot(aes(x = pitch_type, y = Inter_RF, color = pitch_type)) +
geom_point(show.legend = FALSE, size = 2) +
labs(x = "Pitch",
y = "RMSE",
title = "Root Mean Squared Error for Inter-Pitch Random Forest") +
theme_dark()
View(rmse_data)
ff <- inters[["FF"]] %>%
mutate(prediction = mean(est_woba))
ff_rud_rmse <- round(rmse(ff$est_woba, ff$prediction), 4)
fc <- inters[["FC"]] %>%
mutate(prediction = mean(est_woba))
fc_rud_rmse <- round(rmse(fc$est_woba, fc$prediction), 4)
ch <- inters[["CH"]] %>%
mutate(prediction = mean(est_woba))
ch_rud_rmse <- round(rmse(ch$est_woba, ch$prediction), 4)
cu <- inters[["CU"]] %>%
mutate(prediction = mean(est_woba))
cu_rud_rmse <- round(rmse(cu$est_woba, cu$prediction), 4)
sl <- inters[["SL"]] %>%
mutate(prediction = mean(est_woba))
sl_rud_rmse <- round(rmse(sl$est_woba, sl$prediction), 4)
si <- inters[["SI"]] %>%
mutate(prediction = mean(est_woba))
si_rud_rmse <- round(rmse(si$est_woba, si$prediction), 4)
View(rmse_data)
intercept <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(round(rmse(ff$est_woba, ff$prediction), 4),
round(rmse(fc$est_woba, fc$prediction), 4),
round(rmse(si$est_woba, si$prediction), 4),
round(rmse(sl$est_woba, sl$prediction), 4),
round(rmse(cu$est_woba, cu$prediction), 4),
round(rmse(ch$est_woba, ch$prediction), 4))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Inter_RF" = V2)
intercept <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(round(rmse(ff$est_woba, ff$prediction), 4),
round(rmse(fc$est_woba, fc$prediction), 4),
round(rmse(si$est_woba, si$prediction), 4),
round(rmse(sl$est_woba, sl$prediction), 4),
round(rmse(cu$est_woba, cu$prediction), 4),
round(rmse(ch$est_woba, ch$prediction), 4))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Intercept" = V2)
rmse_data <- intercept %>%
left_join(intra_gam, by = "pitch_type") %>%
left_join(inter_gam, by = "pitch_type") %>%
left_join(inter_rf, by = "pitch_type")
View(rmse_data)
intercept <- cbind(c("FF", "FC", "SI", "SL", "CU", "CH"),
c(round(rmse(ff$est_woba, ff$prediction), 4),
rmse(fc$est_woba, fc$prediction),
rmse(si$est_woba, si$prediction),
rmse(sl$est_woba, sl$prediction),
rmse(cu$est_woba, cu$prediction),
rmse(ch$est_woba, ch$prediction))) %>%
as.data.frame() %>%
rename(pitch_type = V1, "Intercept" = V2)
rmse_data <- intercept %>%
left_join(intra_gam, by = "pitch_type") %>%
left_join(inter_gam, by = "pitch_type") %>%
left_join(inter_rf, by = "pitch_type")
View(rmse_data)
rmse_data <- rmse_data %>%
mutate(
Intercept = as.numeric(Intercept)
Intra_GAM = as.numeric(Intra_GAM),
rmse_pivot <- rmse_data %>%
pivot_longer(c(Intercept:Inter_RF)) %>%
rename(RMSE = value, model = name)
rmse_pivot <- rmse_pivot %>%
mutate(RMSE = as.numeric(RMSE))
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, fill = model)) +
geom_boxplot(color = "white", show.legend = FALSE) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = pitch_type, y = RMSE, alpha = 0.5)) +
geom_boxplot() +
theme_dark() +
labs(x = "Model")
rmse_data %>%
kable(digits = 4)
rmse_data %>%
kable(digits = 4)
rmse_data %>%
kable()
View(rmse_data)
rmse_data %>%
```
rmse_data %>%
as.matrix() %>%
kable
rmse_data %>%
kable(digits = 4, align = "c") %>%
kable_styling(full_width = T)
rmse_data %>%
kable(digits = 4, align = "c")
rmse_data %>%
kable(digits = 4, align = "c") %>%
kable_styling(full_width = T)
round(rmse_data, 4) %>%
kable(digits = 4, align = "c") %>%
kable_styling(full_width = T)
rmse_data <- rmse_data %>%
mutate(
Intercept = as.numeric(Intercept),
Intra_GAM = as.numeric(Intra_GAM),
Inter_GAM = as.numeric(Inter_GAM),
Inter_RF = as.numeric(Inter_RF))
rmse_data %>%
mutate(Intercept = round(Intercept, 4),
Intra_GAM = round(Intra_GAM, 4),
Inter_GAM = round(Inter_GAM, 4),
Inter_RF = round(Inter_RF,4)) %>%
kable(digits = 4, align = "c") %>%
kable_styling(full_width = T)
rmse_data %>%
mutate(Intercept = round(Intercept, 4),
Intra_GAM = round(Intra_GAM, 4),
Inter_GAM = round(Inter_GAM, 4),
Inter_RF = round(Inter_RF,4)) %>%
kable(digits = 4, align = "c",
col.names = c("Pitch", "Intercept", "Intra-Pitch GAM",
"Inter-Pitch GAM", "Inter-Pitch RF")) %>%
kable_styling(full_width = T)
rmse_data %>%
mutate(Intercept = round(Intercept, 4),
Intra_GAM = round(Intra_GAM, 4),
Inter_GAM = round(Inter_GAM, 4),
Inter_RF = round(Inter_RF,4)) %>%
mutate(pitch_type = str_replace(pitch_type, "FF", "Four-Seams"),
pitch_type = str_replace(pitch_type, "FC", "Cutters"),
pitch_type = str_replace(pitch_type, "SI", "Sinkers"),
pitch_type = str_replace(pitch_type, "SL", "Sliders"),
pitch_type = str_replace(pitch_type, "CU", "Curveballs"),
pitch_type = str_replace(pitch_type, "CH", "Change-Ups")) %>%
kable(digits = 4, align = "c",
col.names = c("Pitch", "Intercept", "Intra-Pitch GAM",
"Inter-Pitch GAM", "Inter-Pitch RF")) %>%
kable_styling(full_width = T)
rmse_data %>%
mutate(Intercept = round(Intercept, 4),
Intra_GAM = round(Intra_GAM, 4),
Inter_GAM = round(Inter_GAM, 4),
Inter_RF = round(Inter_RF,4)) %>%
mutate(pitch_type = str_replace(pitch_type, "FF", "Four-Seam"),
pitch_type = str_replace(pitch_type, "FC", "Cutter"),
pitch_type = str_replace(pitch_type, "SI", "Sinker"),
pitch_type = str_replace(pitch_type, "SL", "Slider"),
pitch_type = str_replace(pitch_type, "CU", "Curveball"),
pitch_type = str_replace(pitch_type, "CH", "Change-Up")) %>%
kable(digits = 4, align = "c",
col.names = c("Pitch", "Intercept", "Intra-Pitch GAM",
"Inter-Pitch GAM", "Inter-Pitch RF")) %>%
kable_styling(full_width = T)
?geom_jitter
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, fill = model)) +
geom_boxplot(color = "white", show.legend = FALSE) +
geom_jitter(width = 0.25) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, fill = model)) +
geom_boxplot(color = "white", show.legend = FALSE) +
geom_jitter(width = 0.1, color = "white") +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, fill = model)) +
geom_boxplot(color = "white", show.legend = FALSE) +
geom_jitter(width = 0.15, aes(pitch_type)) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE, fill = model)) +
geom_boxplot(color = "white", show.legend = FALSE) +
geom_jitter(width = 0.15, aes(color = pitch_type)) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE)) +
geom_boxplot(color = "white", show.legend = FALSE, aes(fill = model)) +
geom_jitter(width = 0.15, aes(color = pitch_type)) +
theme_dark() +
labs(x = "Model")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE)) +
geom_boxplot(color = "white", show.legend = FALSE, aes(fill = model)) +
geom_jitter(width = 0.15, aes(color = pitch_type)) +
theme_dark() +
labs(x = "Model",
color = "Pitch")
rmse_pivot %>%
ggplot(aes(x = model, y = RMSE)) +
geom_boxplot(color = "white", show.legend = FALSE, aes(fill = model)) +
geom_jitter(width = 0, aes(color = pitch_type)) +
theme_dark() +
labs(x = "Model",
color = "Pitch")

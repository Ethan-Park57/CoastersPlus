ggplot() +
geom_vline(xintercept = 0, color = "white") +
geom_hline(yintercept = 0, color = "white") +
geom_point(aes(x = pitcher_break_x-league$horizontal,
y = pitcher_break_z-league$vertical,
color = pitch_type), alpha = 0.85) +
scale_y_reverse() +
labs(x = "Horizontal Break",
y = "Vertical Break",
title = "Above Average Breaking Balls for Above Average Pitchers",
color = "Pitch") +
xlim(-20, 20) + ylim(40, -40) +
theme(axis.title = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect("black"),
plot.title = element_text(hjust = 0.5)) +
coord_fixed(ratio = 1)
movement %>%
filter(`Stf+ Pitch` >= 130,
Stuff > 110,
pitch_type == "FS" | pitch_type == "CH") %>%
ggplot() +
geom_vline(xintercept = 0, color = "white") +
geom_hline(yintercept = 0, color = "white") +
geom_point(aes(x = pitcher_break_x-league$horizontal,
y = pitcher_break_z-league$vertical,
color = pitch_type), alpha = 0.85) +
scale_y_reverse() +
labs(x = "Horizontal Break",
y = "Vertical Break",
title = "Above Average Off-Speed Pitches for Above Average Pitchers",
color = "Pitch") +
xlim(-20, 20) + ylim(20, -20) +
theme(axis.title = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect("black"),
plot.title = element_text(hjust = 0.5)) +
coord_fixed(ratio = 1)
movement %>%
filter(`Stf+ Pitch` >= 130,
Stuff > 110,
pitch_type == "FF" | pitch_type == "FC" | pitch_type == "SI") %>%
ggplot() +
geom_vline(xintercept = 0, color = "white") +
geom_hline(yintercept = 0, color = "white") +
geom_point(aes(x = pitcher_break_x-league$horizontal,
y = pitcher_break_z-league$vertical,
color = pitch_type), alpha = 0.85) +
scale_y_reverse() +
labs(x = "Horizontal Break",
y = "Vertical Break",
title = "Above Average Fastballs for Above Average Pitchers",
color = "Pitch") +
xlim(-20, 20) + ylim(30, -30) +
theme(axis.title = element_blank(), axis.ticks = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect("black"),
plot.title = element_text(hjust = 0.5)) +
coord_fixed(ratio = 1)
Data2 %>%
filter(speed_diff < 0) %>%
ggplot(aes(x = speed_diff, y = `Stf+ Pitch`)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "green", size = 1.25, alpha = 0.3) +
geom_point(shape = 18, size = 2, alpha = 0.8, aes(color = avg_speed)) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Speed Differential (vs. Fastball)",
y = "Pitch Stuff+",
color = "Pitch Speed") +
scale_color_gradient(low = "yellow", high = "red", limits = c(70, 100)) +
scale_x_reverse() +
NULL
Data2 %>%
filter(speed_diff < 0) %>%
ggplot(aes(x = speed_diff, y = `Stf+ Pitch`)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(shape = 18, size = 2, alpha = 0.8, aes(color = pitch_type_name)) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Speed Differential (vs. Fastball)",
y = "Pitch Stuff+",
color = "Pitch") +
scale_x_reverse() +
NULL
Data2 %>%
ggplot(aes(x = avg_speed, y = `Stf+ Pitch`,
color = pitch_per)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Speed",
y = "Pitch Stuff+",
color = "Pitch Proportion") +
scale_color_gradient(low = "yellow", high = "red", limits = c(0,1)) +
NULL
Data2 %>%
ggplot(aes(x = pitch_per, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
NULL
rm(movement_league)
View(movement)
View(movement)
league<- movement %>%
group_by(pitch_type_name) %>%
summarize("horizontal" =
weighted.mean(pitcher_break_x, pitches_thrown),
"vertical" =
weighted.mean(pitcher_break_z, pitches_thrown),
"prop" =
weighted.mean(pitch_prop, pitches_thrown)) %>%
as.data.frame()
View(league)
Data2 %>%
ggplot(aes(x = pitch_per-league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
scale_x_continuous(values = scales::percent())
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
scale_x_continuous(values = scales::percent()) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
scale_x_continuous(labels = scales::percent()) +
NULL
scale_x_continuous(labels = scales::percent +
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
scale_x_continuous(labels = scales::percent) +
NULL
Data2 %>%
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
scale_x_continuous(labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
scale_x_continuous(labels = scales::percent) +
xlim(-1,3) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
xlim(-1,3) +
scale_x_continuous(labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
xlim(-100%,300%) +
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
scale_x_continuous(limits = c(-1,3), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "yellow", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth() +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_hline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_vline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Prop",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
results <- pitches %>%
select(-c(pos3_int_start_distance:pos9_int_start_distance))
movement <- Data %>%
select(pitch_type, pitch_type_name, Stuff, `Stf+ Pitch`:tail,
avg_speed, pitches_thrown, pitch_per, playerID) %>%
rename(pitch_prop = pitch_per) %>%
filter(!is.na(`Stf+ Pitch`))
movement <- Data %>%
select(pitch_type, pitch_type_name, Stuff, `Stf+ Pitch`:tail,
avg_speed, pitches_thrown, pitch_per, playerID) %>%
rename(pitch_prop = pitch_per) %>%
filter(!is.na(`Stf+ Pitch`))
league <- movement %>%
group_by(pitch_type_name) %>%
summarize("horizontal" =
weighted.mean(pitcher_break_x, pitches_thrown),
"vertical" =
weighted.mean(pitcher_break_z, pitches_thrown),
"prop" =
weighted.mean(pitch_prop, pitches_thrown)) %>%
as.data.frame()
league %>%
kable(digits = 2, align = "c",
col.names = c("Pitch", "Horizontal", "Vertical")) %>%
kable_styling(full_width = T)
league %>%
kable(digits = 2, align = "c",
col.names = c("Pitch", "Horizontal", "Vertical")) %>%
kable_styling(full_width = T)
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_vline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Usage (vs. League Average)",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = avg_speed, y = `Stf+ Pitch`,
color = pitch_per)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.5) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5, method = lm) +
labs(x = "Pitch Speed",
y = "Pitch Stuff+",
color = "Pitch Proportion") +
scale_color_gradient(low = "yellow", high = "red", limits = c(0,1)) +
NULL
Data2 %>%
ggplot(aes(x = (pitch_per-league$prop)/league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_vline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Usage (vs. League Average)",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = pitch_per-league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_vline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Usage",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-1,2.5), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = pitch_per-league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_vline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Usage",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-0.5,1), labels = scales::percent) +
NULL
Data2 %>%
ggplot(aes(x = pitch_per-league$prop, y = `Stf+ Pitch`,
color = woba)) +
theme(panel.background = element_rect("black"),
panel.grid.minor = element_blank(),
panel.grid.major = element_line("darkgray")) +
geom_hline(yintercept = 100, color = "yellow", size = 1, alpha = 0.7) +
geom_vline(xintercept = 0, color = "yellow", size = 1, alpha = 0.7) +
geom_point(alpha = 0.8) +
geom_smooth(se = FALSE, color = "gray92", size = 1.5) +
labs(x = "Pitch Usage",
y = "Pitch Stuff+",
color = "wOBA") +
scale_color_gradient(low = "green", high = "red") +
scale_x_continuous(limits = c(-0.5, 0.75), labels = scales::percent) +
NULL
